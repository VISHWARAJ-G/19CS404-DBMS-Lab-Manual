# Experiment 5: Subqueries and Views

## AIM
To study and implement subqueries and views.

## THEORY

### Subqueries
A subquery is a query inside another SQL query and is embedded in:
- WHERE clause
- HAVING clause
- FROM clause

**Types:**
- **Single-row subquery**:
  Sub queries can also return more than one value. Such results should be made use along with the operators in and any.
- **Multiple-row subquery**:
  Here more than one subquery is used. These multiple sub queries are combined by means of ‘and’ & ‘or’ keywords.
- **Correlated subquery**:
  A subquery is evaluated once for the entire parent statement whereas a correlated Sub query is evaluated once per row processed by the parent statement.

**Example:**
```sql
SELECT * FROM employees
WHERE salary > (SELECT AVG(salary) FROM employees);
```
### Views
A view is a virtual table based on the result of an SQL SELECT query.
**Create View:**
```sql
CREATE VIEW view_name AS
SELECT column1, column2 FROM table_name WHERE condition;
```
**Drop View:**
```sql
DROP VIEW view_name;
```

**Question 1**
--
Write a SQL query to retrieve all columns from the CUSTOMERS table for customers whose salary is LESS than $2500.

```sql
select * from CUSTOMERS c where salary in (select salary from CUSTOMErS where salary < 2500);
```

**Output:**

![image](https://github.com/user-attachments/assets/804487f8-0a79-4b1b-a203-bbab6cb33fbb)

**Question 2**
---
Write a SQL query to Retrieve the names and cities of customers who have the same city as customers with IDs 3 and 7

```sql
select name,city from customer where city in (select city from customer where id in (3,7));
```

**Output:**

![image](https://github.com/user-attachments/assets/c7d87745-ae52-4044-85d2-d61ee14695f6)


**Question 3**
---
Write a SQL query to retrieve all columns from the CUSTOMERS table for customers whose salary is greater than $4500.

```sql
select * from CUSTOMERS where salary in (select salary from CUSTOMERS where salary > 4500);
```

**Output:**

![image](https://github.com/user-attachments/assets/e922b704-6167-44cb-b5f5-dc2cd1fc2a97)

**Question 4**
---
From the following tables write a SQL query to find all orders generated by London-based salespeople. Return ord_no, purch_amt, ord_date, customer_id, salesman_id.

```sql
select * from orders where salesman_id in (select salesman_id from salesman where city = "London");
```

**Output:**

![image](https://github.com/user-attachments/assets/b3e7e871-f97b-453b-9998-677e03da448d)

**Question 5**
---
Write a SQL query to Identify customers whose city is different from the city of the customer with the highest ID

```sql
select * from customer where city != (select city from customer where id in (select max(id) from customer));
```

**Output:**

![image](https://github.com/user-attachments/assets/d6c13852-8d1a-4bce-98c9-e702d547f3d5)


**Question 6**
---
Write a SQL query to retrieve all columns from the CUSTOMERS table for customers whose Address as Delhi

```sql
select * from CUSTOMERS where address in (select address as addr from CUSTOMERS where addr="Delhi");
```

**Output:**

![image](https://github.com/user-attachments/assets/33c8a487-e85f-4fb2-8031-0e56e356ae72)


**Question 7**
---
Write a SQL query to retrieve all columns from the CUSTOMERS table for customers whose salary is EQUAL TO $1500.

```sql
select * from customers where salary in (select salary from CUSTOMERS where salary = 1500);
```

**Output:**

![image](https://github.com/user-attachments/assets/564060a0-2ef2-4a10-bea0-47eb8fca2af0)

**Question 8**
---
Write a SQL query to Retrieve the names of customers who have a phone number that is not shared with any other customer.

```sql
select name from customer where phone in (select phone from customer group by phone having count(*) = 1);
```

**Output:**

![image](https://github.com/user-attachments/assets/02c8ac98-b760-447b-93bf-fd2745ee480e)


**Question 9**
---
Write a SQL query to retrieve all columns from the CUSTOMERS table for customers whose salary is greater than $1500.

```sql
select * from CUSTOMERS where salary in (select salary from CUSTOMERS where salary > 1500);
```

**Output:**

![image](https://github.com/user-attachments/assets/8b40004d-0c22-4aea-a794-95f25e7391de)


**Question 10**
---
From the following tables write a SQL query to find the order values greater than the average order value of 10th October 2012. Return ord_no, purch_amt, ord_date, customer_id, salesman_id.

Note: date should be yyyy-mm-dd format

```sql
select * from ORDERS where purch_amt > (select avg(purch_amt) from ORDERS where ord_date = "2012-10-10");
```

**Output:**

![image](https://github.com/user-attachments/assets/8a02a158-0523-40b3-bc55-31eb1bb69d9d)


## RESULT
Thus, the SQL queries to implement subqueries and views have been executed successfully.
